# yaml-language-server: $schema=https://carapace.sh/schemas/command.json

name: pdfsig
description: Portable Document Format (PDF) digital signatures tool
flags:
  -nssdir=: path to directory of libnss3 database
  -nss-pwd=: password to access the NSS database (if any)
  -nocert: don't perform certificate validation
  -no-ocsp: don't perform online OCSP certificate revocation check
  -no-appearance: don't add appearance information when signing existing fields
  -aia: use Authority Information Access (AIA) extension for certificate fetching
  -assert-signer=: This option checks whether the signature covering the full document been made with the specified key. The key is either specified as a fingerprint or a file listing fingerprints. The fingerprint must be given or listed in compact format (no colons or spaces in between). If fpr_or_file specifies a file, empty lines are ignored as well as all lines starting with a hash sign. Only available for GnuPG backend.
  -dump: dump all signatures into current directory
  -add-signature: adds a new signature to the document
  -new-signature-field-name=: field name used for the newly added signature. A random ID will be used if empty
  -sign=: sign the document in the given signature field (by name or number)
  -etsi: create a signature of type ETSI.CAdES.detached instead of adbe.pkcs7.detached
  -backend=: use given backend for signing/verification
  -enable-pgp: Enable pgp signatures in the GnuPG backend. Only available for GnuPG backend
  -nick=: use the certificate with the given nickname/fingerprint for signing
  -kpw=: password for the signing key (might be missing if the key isn't password protected)
  -digest=: name of the digest algorithm
  -reason=: reason for signing
  -list-nicks: list available nicknames in the NSS database
  -list-backends: print cryptographic signature backends
  -opw=: owner password (for encrypted files)
  -upw=: user password (for encrypted files)
  -v: print copyright and version info
  -h: print usage information
  -help, --help: print usage information
  -?: print usage information

completion:
  flag:
    nssdir: ["$directories"]

  positional:
    - ["$files"]
    - ["$files"]
